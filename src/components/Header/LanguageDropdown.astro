---
---

<div class="language-dropdown relative">
  <button class="language-button flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-800 transition-colors">
    <span class="text-2xl current-flag">ğŸ‡¬ğŸ‡§</span>
    <span class="text-white font-semibold current-lang">EN</span>
    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
    </svg>
  </button>
  
  <div class="language-menu absolute right-0 mt-2 w-40 bg-gray-900 rounded-lg shadow-lg border border-gray-700 hidden z-50">
    <button class="lang-option w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-800 transition-colors" data-lang="en">
      <span class="text-2xl">ğŸ‡¬ğŸ‡§</span>
      <span class="text-white">English</span>
    </button>
    <button class="lang-option w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-800 transition-colors" data-lang="es">
      <span class="text-2xl">ğŸ‡ªğŸ‡¸</span>
      <span class="text-white">EspaÃ±ol</span>
    </button>
  </div>
</div>

<script>
  function initLanguageDropdown() {
    const button = document.querySelector('.language-button');
    const menu = document.querySelector('.language-menu');
    const options = document.querySelectorAll('.lang-option');
    const currentFlag = document.querySelector('.current-flag');
    const currentLang = document.querySelector('.current-lang');

    // Get stored language
    const storedLang = localStorage.getItem('language') || 'en';
    updateCurrentLanguage(storedLang);

    button?.addEventListener('click', (e) => {
      e.stopPropagation();
      menu?.classList.toggle('hidden');
    });

    options.forEach(option => {
      option.addEventListener('click', () => {
        const lang = option.getAttribute('data-lang');
        if (lang) {
          localStorage.setItem('language', lang);
          updateCurrentLanguage(lang);
          menu?.classList.add('hidden');
          
          // Dispatch custom event for translation update
          window.dispatchEvent(new Event('languagechange'));
        }
      });
    });

    // Close menu when clicking outside
    document.addEventListener('click', () => {
      menu?.classList.add('hidden');
    });

    function updateCurrentLanguage(lang: string) {
      const flags: Record<string, string> = {
        'en': 'ğŸ‡¬ğŸ‡§',
        'es': 'ğŸ‡ªğŸ‡¸'
      };
      
      if (currentFlag) currentFlag.textContent = flags[lang] || 'ğŸ‡¬ğŸ‡§';
      if (currentLang) currentLang.textContent = lang.toUpperCase();
    }
  }

  // Initialize on load
  document.addEventListener('DOMContentLoaded', initLanguageDropdown);
</script>
